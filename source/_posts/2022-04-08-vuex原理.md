---
layout: default
title: Vuex 原理
description: Vuex
categories: [Vue]
tags: [Vue]
---
# {{ page.title }}

## 1 概述

Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用集中式存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。

## 基础应用

```javascript
// store.js 定义store
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex) // 调用vuex的install方法初始化

const store = new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increment (state) {
      state.count++
    }
  },
  actions: {}
})
```

```javascript
    new Vue({
        el: '#app',
        store: store, // 导入store
    })
```

```javascript
// 业务代码中应用
this.$store.commit('increment')
```

## 原理简述

### 1：导出 install 方法

install中 mixin 混合 beforeCreate 钩子函数，vue从外到内执行beforeCreate时，给vue实例增加$store属性

### 2：导出Store 类（class）

- 1：根据参数的state初始化响应式state
- 2：处理modules，生成树结构
- 3：处理深层getters，mutations，actions,state，---根据modules树结构，反向把上面三项内容都挂载到根的相应属性上，其中mutations和actions是数组
- 4：处理plugins，插件中可以订阅方法，commit时候执行订阅的方法
- 5：定义commit、dispatch方法。

[源码地址](https://github.com/happychong/2019-zhufeng/tree/master/17.my-vuex/src)


